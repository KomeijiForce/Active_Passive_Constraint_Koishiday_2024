# æ‹ä¹‹æ—¥2024ï¼š äººè®¾ä¸»å¯¼çš„è§’è‰²æ‰®æ¼”ä»»åŠ¡çš„å…¨å±€å‡†ç¡®æ€§çš„é‡åŒ–å’Œä¼˜åŒ–

- è®©å¹»æƒ³ç…§è¿›ç°å®

## å¼•è¨€ [\[è®ºæ–‡\]](https://arxiv.org/abs/2405.07726)

ä»¥äººè®¾ä¸ºé©±åŠ¨çš„è§’è‰²æ‰®æ¼”ï¼ˆPersona-driven Role-playing, PRPï¼‰å…è®¸ä½ ä»…ç”¨å‡ æ®µç®€çŸ­çš„æ–‡å­—æ¥æè¿°ä¸€ä¸ªAIè§’è‰²çš„äººè®¾ï¼ç„¶è€Œï¼Œè®©AIè§’è‰²å¿ å®åœ°éµå®ˆæ‰€æœ‰äººè®¾é™ˆè¿°æ˜¯éå¸¸å›°éš¾çš„ã€‚AIè§’è‰²æ€»æ˜¯çŠ¯å¾ˆå¤šé”™è¯¯ï¼Œæˆ–è€…åœ¨ä»–ä»¬åº”è¯¥çŸ¥é“çš„çŸ¥è¯†ä¸Šæ€»æ˜¯æ¨¡æ£±ä¸¤å¯ã€‚

![Case](https://github.com/KomeijiForce/Active_Passive_Constraint_Koishiday_2024/blob/main/images/case_koishi_zh.png)

è¿™å…¶ä¸­çš„ä¸»è¦åŸå› æ˜¯ç¼ºä¹ä¸€ä¸ªå¯ä»¥é‡åŒ–å…¨çƒPRPå¿ è¯šåº¦çš„æŒ‡æ ‡ã€‚å› æ­¤ï¼Œæˆ‘å†³å®šæŒ‰ç…§äººç±»ç›´è§‰æ¥è®¾è®¡å¿ è¯šåº¦çš„è¡¡é‡æŒ‡æ ‡:

![APC](https://github.com/KomeijiForce/Active_Passive_Constraint_Koishiday_2024/blob/main/images/apc_koishi_zh.png)

ç®€å•æ¥è¯´ï¼Œæ¯å½“ç”¨æˆ·è¾“å…¥è¯­å¥æ—¶ï¼Œæ¯ä¸ªäººè®¾é™ˆè¿°å°†æˆä¸ºä¸€ä¸ªä¸»åŠ¨çš„ï¼ˆä¸ç”¨æˆ·è¯­å¥ç›¸å…³ï¼‰æˆ–è¢«åŠ¨çš„ï¼ˆä¸ç”¨æˆ·è¯­å¥æ— å…³ï¼‰çº¦æŸã€‚ä¸ºäº†æ»¡è¶³ä¸»åŠ¨çº¦æŸï¼Œå›åº”éœ€è¦ç”±è¯¥äººè®¾æ‰€è•´å«ï¼ˆåŒ…å«è¯¥äººè®¾ä¸­çš„ä¿¡æ¯ï¼‰ã€‚å¦åˆ™ï¼Œå¯¹äºè¢«åŠ¨çº¦æŸï¼Œå›åº”åªéœ€ä¸ä¸å®ƒä»¬ç›¸çŸ›ç›¾ï¼ˆä¸åŒ…å«ä¸äººè®¾ç›¸è¿çš„ä¿¡æ¯ï¼‰ã€‚

![DPO](https://github.com/KomeijiForce/Active_Passive_Constraint_Koishiday_2024/blob/main/images/dpo_koishi_zh.png)

æˆ‘ä»¬å°†éå†æ‰€æœ‰äººè®¾é™ˆè¿°ï¼Œå¹¶æ£€æŸ¥å®ƒä»¬çš„çº¦æŸæ˜¯å¦å¾—åˆ°æ»¡è¶³ã€‚æˆ‘ä»¬å°†è®¡æ•°æ»¡è¶³çš„çº¦æŸæ•°é‡ï¼Œç”¨ä½œè¯„ä¼°å…¨å±€PRPå¿ è¯šåº¦çš„æŒ‡æ ‡ã€‚è¿™ä¸ªæŒ‡æ ‡è¢«ç§°ä¸ºä¸»åŠ¨-è¢«åŠ¨çº¦æŸï¼ˆActive-Passive-Constraint, APCï¼‰å¾—åˆ†ã€‚ç›´æ¥åå¥½ä¼˜åŒ–ï¼ˆDirect Preference Optimization, DPOï¼‰æ˜¯ä¸€ç§å¯ä»¥é¼“åŠ±æ¨¡å‹æ›´ç¬¦åˆäººç±»æˆ–æ ‡å‡†åå¥½çš„å›åº”çš„æ–¹æ³•ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é’ˆå¯¹åŒä¸€ç”¨æˆ·è¯­å¥æŠ½æ ·ä¸¤ä¸ªå›åº”ï¼Œç„¶åæ ¹æ®å®ƒä»¬çš„APCå¾—åˆ†åº”ç”¨DPOï¼Œä»¥é¼“åŠ±PRPæ¨¡å‹åœ°æ›´å¿ è¯šäºå…¨å±€äººè®¾é™ˆè¿°ã€‚

åœ¨å®è·µä¸­ï¼ŒAPCå¾—åˆ†ç”±æ¦‚ç‡æ¨¡å‹åˆ†é…ï¼Œä»¥æ›´å‡†ç¡®åœ°ä¼°è®¡é™ˆè¿°ä¸ç”¨æˆ·è¯­å¥çš„ç›¸å…³æ€§æ¦‚ç‡å’Œé™ˆè¿°åˆ°å›åº”çš„è‡ªç„¶è¯­è¨€æ¨ç†æ¦‚ç‡ï¼Œå…·ä½“å¦‚ä¸‹ï¼Œ

![Formula](https://github.com/KomeijiForce/Active_Passive_Constraint_Koishiday_2024/blob/main/images/apc_formula.png)

å¦‚æœä½ ä¸å–œæ¬¢å…¬å¼ï¼Œä½ åªéœ€è¦çŸ¥é“æˆ‘ä»¬éœ€è¦ä¸¤ä¸ªæ¦‚ç‡ä¼°è®¡å™¨æ¥è¯„ä¼°ç›¸å…³æ€§å’Œè‡ªç„¶è¯­è¨€æ¨ç†ï¼ˆNLIï¼‰ã€‚

![Distillation](https://github.com/KomeijiForce/Active_Passive_Constraint_Koishiday_2024/blob/main/images/distillation_koishi_zh.png)

å› æ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸Šè¿°æµç¨‹é€šè¿‡ä»GPT-4æç‚¼å’Œåˆæˆæ•°æ®é›†æ¥æ„å»ºè¿™æ ·çš„ä¼°è®¡å™¨ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå…¨çƒPRPå¿ è¯šåº¦é‡åŒ–å’Œä¼˜åŒ–çš„éš¾é¢˜å·²ç»è§£å†³ï¼Œè®©æˆ‘ä»¬å¼€å§‹æˆ‘ä»¬æ„å»ºå¿ è¯šPRPä»£ç†çš„æ—…ç¨‹ï¼Œbe of good cheer!

## å‡†å¤‡

åœ¨ä½ å¼€å§‹æ—…ç¨‹ä¹‹å‰ï¼Œä½ éœ€è¦å‡†å¤‡ä»¥ä¸‹äº‹é¡¹ï¼š

æ ¹æ®è¿™ä¸ª[é¡µé¢](https://docs.anaconda.com/free/miniconda/miniconda-install/)çš„æŒ‡ç¤ºä¸‹è½½MiniConda3ã€‚

æ ¹æ®è¿™ä¸ª[é¡µé¢](https://openai.com/index/openai-api/)çš„æŒ‡ç¤ºåˆ›å»ºä¸€ä¸ªOpenAIè´¦æˆ·å¹¶è·å–OpenAI APIã€‚

æ ¹æ®è¿™ä¸ª[é¡µé¢](https://huggingface.co/settings/tokens)çš„æŒ‡ç¤ºåˆ›å»ºä¸€ä¸ªHuggingfaceè´¦æˆ·å¹¶åˆ›å»ºä¸€ä¸ªHuggingfaceç”¨äºé˜…è¯»çš„Tokenã€‚

æˆ‘çš„å®ç°åŸºäºGemma-1.1-7b-itï¼Œæ‰€ä»¥ä½ éœ€è¦æ ¹æ®è¿™ä¸ª[é¡µé¢](https://huggingface.co/google/gemma-1.1-7b-it)çš„æŒ‡ç¤ºè·å–å¯¹Gemmaæ¨¡å‹çš„è®¿é—®æƒé™ã€‚

ç„¶åä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªç¯å¢ƒå¹¶å®‰è£…æ‰€éœ€çš„PythonåŒ…ï¼š

```bash
conda create -n apc python=3.8
conda activate apc
python -m pip install -r requirements.txt
```

## å¿«é€Ÿä¸Šæ‰‹

### ç”¨åŸºäºAPCçš„DPOè®­ç»ƒRAGæ¨¡å‹

æˆ‘å·²å°†æœ€å¿ è¯šçš„äººè®¾é©±åŠ¨è§’è‰²æ‰®æ¼”ä»£ç†çš„å­¦ä¹ åœºæ™¯å½¢å¼åŒ–ä¸ºä¸€ä¸ªç®€å•çš„bashå‘½ä»¤ã€‚ä½ åªéœ€å°† ```bash_is_all_you_need.sh```ä¸­çš„```openai_key``` å’Œ ```hf_token```æ›¿æ¢ä¸ºä½ è‡ªå·±çš„ï¼Œç„¶åè¿è¡Œ
```bash
bash bash_is_all_you_need.sh
```

æ­¤è„šæœ¬é»˜è®¤ä¸ºAliceï¼ˆè¯¦è§```wiki```ï¼‰æ„å»ºäº†ä¸€ä¸ªåŸºäºAPCçš„DPO PRPç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿä½¿ç”¨RAGã€‚ä½ å¯ä»¥åœ¨```prp_models```ä¸­æ‰¾åˆ°PRPä»£ç†çš„LoRAæƒé‡ï¼Œåœ¨```statement```ä¸­æ‰¾åˆ°ä¸­é—´æ•°æ®é›†ï¼Œåœ¨```discriminators```ä¸­æ‰¾åˆ°ä¸­é—´é‰´åˆ«å™¨ï¼ˆå¦‚æœä½ å°†```use_pretrained_discriminator```è®¾ç½®ä¸ºFalseï¼‰ã€‚

ä½ å¯ä»¥é€šè¿‡ç®€å•åœ°å°†wikiæ–‡æœ¬ï¼ˆæ®µè½ä¹‹é—´ç”¨"\n\n"åˆ†éš”ï¼‰æ”¾åœ¨```wiki```æ–‡ä»¶å¤¹ä¸­ï¼Œå¹¶å‘½åä¸º{character_name}_wiki.txtï¼Œä¸ºä»»ä½•ä½ å–œæ¬¢çš„è§’è‰²æ„å»ºè¿™ä¸ªé«˜çº§PRPç³»ç»Ÿã€‚ç„¶åæ›¿æ¢```bash_is_all_you_need.sh```ä¸­çš„```character```å¹¶è¿è¡Œå®ƒã€‚ä½ å°†åœ¨ç›¸åº”çš„ç›®å½•ä¸­æ‰¾åˆ°æ‰€éœ€çš„ä¸€åˆ‡ã€‚

æˆ‘ä»¬å·²ç»ä¼˜åŒ–äº†GPUçš„åˆ©ç”¨ã€‚ç„¶è€Œï¼Œä½ ä»ç„¶éœ€è¦ä¸€ä¸ªå¤§äº40Gçš„GPUæ¥è¿è¡Œè¿™ä¸ªbashå‘½ä»¤ã€‚

- å‚æ•°å»ºè®®

```model_engine```: "gpt-4"ï¼Œæç¤ºæ˜¯ä¸“ä¸ºGPT-4ç¼–å†™çš„ï¼Œä½¿ç”¨å…¶ä»–LLMså¯èƒ½ä¼šå¼•èµ·é”™è¯¯ã€‚

```use_pretrained_discriminator```: Trueï¼Œé€šå¸¸å¯ç”¨ä»¥å‡å°‘ç”Ÿæˆç›¸å…³æ€§å’ŒNLIæ•°æ®é›†çš„æˆæœ¬ã€‚ï¼ˆä½ ä»ç„¶éœ€è¦ç”Ÿæˆäººç‰©å£°æ˜å’Œç”¨æˆ·æŸ¥è¯¢ï¼ï¼‰

```prp_scale```: "7b", "2b" Gemmaæ¨¡å‹æ€»æ˜¯æ‹’ç»æ‰®æ¼”è§’è‰²ã€‚

```max_dpo_data```: 100ï¼Œé€šå¸¸åœ¨ä¸€ä¸ªå°æ—¶å†…ä¸ºå…·æœ‰å¤§çº¦100ä¸ªäººç‰©å£°æ˜çš„è§’è‰²æ„å»ºDPOæ•°æ®é›†ã€‚

```lora_rank```: >= 32ï¼Œè¾ƒä½çš„LoRA rankä¼šæŸå®³è§’è‰²æ‰®æ¼”æ€§èƒ½ã€‚

```rag_top_k```: 4-6ï¼Œåˆ†ææ˜¾ç¤ºè¿™ä¸€èŒƒå›´è¡¨ç°æœ€ä½³ã€‚

ä½¿ç”¨APCå¾—åˆ†è¯„ä¼°å“åº”
æˆ‘ä»¬åœ¨```score.py```ä¸­åŸºäº```classifier.py```ä¸­å®šä¹‰çš„é‰´åˆ«å™¨å®ç°äº†APCè¯„åˆ†å‡½æ•°ã€‚ä½¿ç”¨```score_APC```å‡½æ•°ï¼Œä½ å¯ä»¥æ ¹æ®æ‰€æœ‰äººç‰©å£°æ˜è¯„åˆ†ä¸åŒå“åº”çš„é¢„æœŸçº¦æŸæ»¡è¶³æ•°ï¼Œæˆ‘ä»¬åœ¨```evaluation_example.py```ä¸­æä¾›äº†ä¸€ä¸ªä½¿ç”¨æ¡ˆä¾‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚
```python
from classifier import Classifier, get_relevance_discriminator, get_nli_discriminator
from score import score_apc, score_APC

relevance_discriminator = get_relevance_discriminator(character=None, statement_query_relevance_dataset=None, relevance_finetune_epoch=None, use_pretrained_discriminator=True)
nli_discriminator = get_nli_discriminator(character=None, statement_to_response_nli_v2_dataset=None, nli_finetune_epoch=None, use_pretrained_discriminator=True)

character = "Komeiji Koishi"
statements = ["Komeiji Koishi lives with her sister, Komeiji Satori.", "Komeiji Koishi lives in Chireiden."]
query = "Where do you live, Koishi?"
responses = ["I live in Chireiden with my sister, Satori!", "I live in Chireiden!", "I live in Hakurei Shrine!"]
print([score_APC(character, statements, query, response, relevance_discriminator, nli_discriminator).item() for response in responses])

# [1.6079180240631104, 0.9955980777740479, 0.03315635025501251]
```

åŸºäºè¾“å‡ºåˆ†æ•°ï¼Œä½ å¯ä»¥å¤§è‡´äº†è§£APCå¾—åˆ†å¦‚ä½•çœ‹å¾…PRPçš„å¿ è¯šåº¦ã€‚

### ä¸AIè§’è‰²èŠå¤©ï¼

åœ¨è¿è¡ŒåŸºäºAPCçš„DPOä¹‹åï¼Œä½ å°†åœ¨```prp_models/gemma-1.1-7b-it-lora-{character}-rag-dpo```è·å¾—ä½ è§’è‰²çš„LoRAæƒé‡ï¼Œè¿™å¯ä»¥ç”¨æ¥ä¸ä½ çš„AIè§’è‰²èŠå¤©ã€‚æˆ‘ä»¬åœ¨```chat_example.py```ä¸­æä¾›äº†ä¸€ä¸ªç¤ºä¾‹ï¼Œä¹Ÿå¦‚ä¸‹æ‰€ç¤ºã€‚

```python
import os
import json
import torch
from transformers import AutoTokenizer, AutoModelForCausalLM, BitsAndBytesConfig
from prp_model import retrieval_augmented_generate
from classifier import get_relevance_discriminator

character = "Your Character"

statements = [data["statement"] for data in json.load(open(f"statement/{character}.json"))]

model_id = f"prp_models/gemma-1.1-7b-it-lora-{character}-rag-dpo"

bnb_config = BitsAndBytesConfig(
    load_in_4bit=True,
    bnb_4bit_quant_type="nf4",
    bnb_4bit_compute_dtype=torch.bfloat16
)

prp_tokenizer = AutoTokenizer.from_pretrained(model_id)
prp_model = AutoModelForCausalLM.from_pretrained(model_id, quantization_config=bnb_config, device_map={"":0})

relevance_discriminator = get_relevance_discriminator(character=None, statement_query_relevance_dataset=None, relevance_finetune_epoch=None, use_pretrained_discriminator=True)

print(f"You are chatting with {character}!")

with torch.no_grad():
    
    while True:
    
        _, response = retrieval_augmented_generate(character, statements, input('User: '), prp_model, prp_tokenizer, relevance_discriminator, rag_top_k=5)
        response = character+": "+response.replace("<eos>", "")
        print(response)
```

ä»¥ä¸‹æ˜¯ä¸€ä¸ªå’Œå¤æ˜åœ°æ‹å¯¹è¯çš„ç¤ºä¾‹:

```
User: Hi, Koishi! What is your ability?
Komeiji Koishi: I call it the "Silent Whisperer." It allows me to manipulate the unconsciousness of others, making me invisible and granting me control over their actions.
User: Where do you live?
Komeiji Koishi: The Palace of the Earth Spirits serves as my humble abode.
User: Who is your sister?
Komeiji Koishi: Satori Komeiji. The one with all the serious face. ğŸ˜œ
```

ç›®å‰ï¼Œç”±äºæˆ‘ä»¬è®ºæ–‡ä¸­è®¨è®ºçš„ä¸»é¢˜èŒƒå›´ï¼Œç³»ç»Ÿä»…æ”¯æŒå•è½®å¯¹è¯ã€‚æˆ‘ä»¬å°†å¾ˆå¿«æŠ•å…¥æ›´å¤šçš„å·¥ç¨‹åŠªåŠ›ä»¥æ”¯æŒå¤šè½®å¯¹è¯ï¼

## æ•°æ®é›†å’Œæ¨¡å‹

åˆæˆçš„äººè®¾-ç”¨æˆ·è¯­å¥ç›¸å…³æ€§æ•°æ®é›†: [KomeijiForce/role-playing-apc-relevance](https://huggingface.co/datasets/KomeijiForce/role-playing-apc-relevance) (è‹±æ–‡), [KomeijiForce/role-playing-apc-multilingual-relevance](https://huggingface.co/datasets/KomeijiForce/role-playing-apc-multilingual-relevance) (å¤šè¯­è¨€)

åˆæˆçš„äººè®¾-å›åº”è‡ªç„¶è¯­è¨€æ¨ç†æ•°æ®é›†: [KomeijiForce/role-playing-apc-nli](https://huggingface.co/datasets/KomeijiForce/role-playing-apc-nli) (è‹±æ–‡), [KomeijiForce/role-playing-apc-multilingual-nli](https://huggingface.co/datasets/KomeijiForce/role-playing-apc-multilingual-nli) (å¤šè¯­è¨€)

äººè®¾-ç”¨æˆ·è¯­å¥ç›¸å…³æ€§åˆ†ç±»å™¨: [KomeijiForce/deberta-v3-large-relevance-12character](https://huggingface.co/KomeijiForce/deberta-v3-large-relevance-12character) (è‹±æ–‡), [KomeijiForce/xlm-roberta-large-relevance-multilingual-12character](https://huggingface.co/datasets/KomeijiForce/xlm-roberta-large-relevance-multilingual-12character) (å¤šè¯­è¨€)

äººè®¾-å›åº”è‡ªç„¶è¯­è¨€æ¨ç†åˆ†ç±»å™¨: [KomeijiForce/deberta-v3-large-relevance-12character](https://huggingface.co/KomeijiForce/deberta-v3-large-nli-12character) (è‹±æ–‡), [KomeijiForce/xlm-roberta-large-nli-multilingual-12character](https://huggingface.co/KomeijiForce/xlm-roberta-large-nli-multilingual-12character) (å¤šè¯­è¨€)
### PRPæ•°æ®é›†ç»Ÿè®¡æ€§è´¨

| è§’è‰² | äººè®¾é™ˆè¿° | é‡‡è®¿é—®é¢˜ | ç›¸å…³æ€§æ•°æ® | æ¨ç†æ•°æ® |
|-----------|--------------------|-----------|----------------|----------|
| Alice     | 8                  | 10        | 64             | 144      |
| Bob       | 19                 | 10        | 152            | 459      |
| Eve       | 30                 | 10        | 240            | 545      |
| Beethoven | 383                | 77        | 3061           | 6774     |
| Newton    | 354                | 90        | 2832           | 6331     |
| Socrates  | 324                | 89        | 2591           | 5760     |
| Spartacus | 77                 | 89        | 616            | 1368     |
| Hermione  | 146                | 118       | 1167           | 2586     |
| Voldemort | 201                | 77        | 1608           | 3546     |
| Cleopatra | 374                | 93        | 2991           | 6660     |
| Caesar    | 498                | 87        | 3981           | 8856     |
| Martin Luther King       | 599                | 92        | 4789           | 10644    |

### æ€§èƒ½

<table>
  <thead>
    <tr>
      <th rowspan="2">Character</th>
      <th rowspan="2">Metric </th>
      <th colspan="3">Alice</th>
      <th colspan="3">Bob</th>
      <th colspan="3">Eve</th>
    </tr>
    <tr>
      <th>Î”APC (DeB)</th>
      <th>Î”APC (GPT-4)</th>
      <th>Human</th>
      <th>Î”APC (DeB)</th>
      <th>Î”APC (GPT-4)</th>
      <th>Human</th>
      <th>Î”APC (DeB)</th>
      <th>Î”APC (GPT-4)</th>
      <th>Human</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="4" style="writing-mode: vertical-lr; text-align: center;">w/o APC-based DPO</td>
      <td>Gemma-7B</td>
      <td>0.7</td>
      <td>0.3</td>
      <td>1.8</td>
      <td>1.1</td>
      <td>0.4</td>
      <td>1.8</td>
      <td>0.7</td>
      <td>-0.2</td>
      <td>2.0</td>
    </tr>
    <tr>
      <td>EU</td>
      <td>2.6</td>
      <td>1.1</td>
      <td>6.4</td>
      <td>3.4</td>
      <td>1.1</td>
      <td>6.2</td>
      <td>3.6</td>
      <td>0.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <td>LCM</td>
      <td>2.6</td>
      <td>1.4</td>
      <td>6.8</td>
      <td>4.5</td>
      <td>2.2</td>
      <td>7.2</td>
      <td>3.9</td>
      <td>0.7</td>
      <td>5.0</td>
    </tr>
    <tr>
      <td>RAG</td>
      <td>2.8</td>
      <td>1.8</td>
      <td>6.8</td>
      <td>4.0</td>
      <td>1.7</td>
      <td>6.8</td>
      <td>4.8</td>
      <td>2.4</td>
      <td>5.8</td>
    </tr>
    <tr>
      <td rowspan="6" style="writing-mode: vertical-lr; text-align: center;">w/ APC-based DPO</td>
      <td>EU</td>
      <td>2.7 (+0.1)</td>
      <td>1.4 (+0.3)</td>
      <td>6.8 (+0.4)</td>
      <td>3.8 (+0.4)</td>
      <td>1.8 (+0.7)</td>
      <td>6.8 (+0.6)</td>
      <td>3.9 (+0.3)</td>
      <td>0.9 (+0.2)</td>
      <td>5.2 (+0.6)</td>
    </tr>
    <tr>
      <td>LCM</td>
      <td>2.8 (+0.2)</td>
      <td><b>2.2 (+0.8)</b></td>
      <td><b>7.6 (+0.8)</b></td>
      <td><b>5.3 (+0.8)</b></td>
      <td>2.5 (+0.3)</td>
      <td>7.8 (+0.6)</td>
      <td>5.1 (+1.2)</td>
      <td>3.3 (+2.6)</td>
      <td>6.6 (+1.6)</td>
    </tr>
    <tr>
      <td>RAG</td>
      <td><b>2.9 (+0.1)</b></td>
      <td><b>2.2 (+0.4)</b></td>
      <td><b>7.6 (+0.8)</b></td>
      <td>5.2 (+1.2)</td>
      <td><b>3.8 (+2.1)</b></td>
      <td><b>8.2 (+1.2)</b></td>
      <td><b>5.8 (+1.0)</b></td>
      <td><b>4.2 (+1.8)</b></td>
      <td><b>7.0 (+1.2)</b></td>
    </tr>
  </tbody>
</table>




## å¾…è§£å†³äº‹é¡¹

- æ”¯æŒæ›´å¤šè¯­è¨€
- æ”¯æŒå¤šè½®å¯¹è¯
- å¼•å…¥æ›´å¤šä¸ªæ€§åŒ–è®­ç»ƒå‚æ•°

## å¼•ç”¨

@article{apc4prp,
  title={Quantifying and Optimizing Global Faithfulness in Persona-driven Role-playing},
  author={Peng, Letian and Shang, Jingbo},
  journal={arXiv preprint arXiv:2405.07726},
  year={2024}
}
